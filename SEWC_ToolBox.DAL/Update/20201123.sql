alter table [t_ReportIssue] add ReportTitle varchar(256) ;
alter table [t_ReportIssue] add AdminOwner varchar(32) ;
alter table [t_ReportIssue] add AdminOwnerName varchar(32) ;
alter table [t_ReportIssue] add AnswerReason varchar(2560) ;
alter table [t_ReportIssue] add AnswerDetail Text;
alter table [t_ReportIssue] add HandleUser varchar(32);
alter table [t_ReportIssue] add HandleUserName varchar(32) ;
alter table [t_ReportIssue] add HandleTime Datetime;
alter table [t_ReportIssue] add CreateUserName varchar(32) ;
alter table [t_ReportIssue] add State smallint default(2) not null;
alter table [t_ReportIssue] add Groups smallint default(1) not null;
update [t_ReportIssue] set State=1;



INSERT INTO t_Menu_New(m_ParentID,m_e_ID,m_DeptID,m_MenuName,m_ActionName,m_AccessLevel,m_IsGeneral,m_Sort)
values(96,8,17,'Issue Feedback','IssueFeedback',1,1,2);


insert into t_MailTemplate(t_mt_Name,t_mt_Title,t_mt_Content)
values('Report_Errors_Reply','[SEWC ToolBox] Report Errors Reply-','<html>   <head>    <style>          span {              font-family: "Arial", "Cambria","serif","宋体";              font-size: 12px;          }      </style>    </head>   <body>    <br />    <br />     <table class="div_Head" style="width: 770px; height: 122px;" cellpadding="0" cellspacing="2">      <tbody>      <tr style="width: 770px; height: 90px;">        <td colspan="4" style="width: 350px; height: 90px; background-color: #879BAA; padding-left: 45px; vertical-align:top;"> <img src="cid:attach0" alt="Siemens-logo" /> </td>        <td colspan="6" style="width: 420px; height: 90px;"> <img style="width: 420px; height: 90px;" src="cid:attach1" alt="Siemens-head" /> </td>       </tr>       <tr style="width: 770px; height: 30px;">        <td colspan="10" style="width: 770px; height: 30px; background-color: #BECDD7; vertical-align: middle; padding-left: 45px;"> <span style="font-size: 13px; color: #ffffff; font-weight: bold;">SEWC ToolBox System</span> </td>       </tr>      </tbody>    </table>     <table class="div_Title" style="margin-left: 45px; width: 705px;" cellpadding="0" cellspacing="0">      <tbody>      <tr>        <td style="width: 100%; height: 30px; border-bottom: 2px solid #adbecb; padding-top:40px;"> <span style="font-size: 21px; font-weight: bold; color: #697882;">Report Errors Reply</span> </td>       </tr>      </tbody>    </table>     <table class="div_Content" style="margin-left: 45px; width: 705px; min-height: 200px;" cellpadding="0" cellspacing="0">      <tbody>      <tr>        <td style="width: 705px; height: 100%;"> <span>Dear $$.Report_Admin_En,</span><br /> <br /> <span>The Issue already fiexd, pls review the details, thanks!</span><br /> <br /><br />         <!-- <span><i><b>Submit user Information</b></i></span><br />                  <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">                      <tbody>                          <tr>                              <td style="width: 120px;"><span><b>Name</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_Name</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>GID</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_GID</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>Email</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_Email</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>Job Title</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_JobTitle</span></td>                          </tr>                      </tbody>                  </table>            <br />   --> <span><i><b>Report Information</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="width: 120px;"><span><b>Name</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.Report_Name</span></td>           </tr>           <tr>            <td style="width: 120px;"><span><b>Report Owner</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.Report_Owner</span></td>           </tr>           <tr>            <td style="width: 120px;"><span><b>Access Owner</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.Report_AccessOwner</span></td>           </tr>          </tbody>         </table>      <br /> <span><i><b>Errors</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.AccessReason</span></td>           </tr>          </tbody>         </table>      <br /> <span><i><b>Errors Reason</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.ErrorReason</span></td>           </tr>          </tbody>         </table>      <br /> <span><i><b>Solutions</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.ErrorSolution</span></td>           </tr>          </tbody>         </table>      </td>       </tr>      </tbody>    </table>     <div class="div_Split" style="margin-top: 50px; margin-bottom: 50px; width: 770px; display: block;">      <span style="font-size: 16px; color: #adbecb;"><i>Chinese Version follows……</i></span>     </div>     <table class="div_Head" style="width: 770px; height: 122px;" cellpadding="0" cellspacing="2">      <tbody>      <tr style="width: 770px; height: 90px;">        <td colspan="4" style="width: 350px; height: 90px; background-color: #879BAA; padding-left: 45px; vertical-align:top;"> <img src="cid:attach0" alt="Siemens-logo" /> </td>        <td colspan="6" style="width: 420px; height: 90px;"> <img style="width: 420px; height: 90px;" src="cid:attach1" alt="Siemens-head" /> </td>       </tr>       <tr style="width: 770px; height: 30px;">        <td colspan="10" style="width: 770px; height: 30px; background-color: #BECDD7; vertical-align: middle; padding-left: 45px;"> <span style="font-size: 13px; color: #ffffff; font-weight: bold;">SEWC 工具箱系统</span> </td>       </tr>      </tbody>    </table>     <table class="div_Title" style="margin-left: 45px; width: 705px;" cellpadding="0" cellspacing="0">      <tbody>      <tr>        <td style="width: 100%; height: 30px; border-bottom: 2px solid #adbecb; padding-top:40px;"> <span style="font-size: 21px; font-weight: bold; color: #697882;">报错回复</span> </td>       </tr>      </tbody>    </table>     <table class="div_Content" style="margin-left: 45px; width: 705px;  min-height: 200px;" cellpadding="0" cellspacing="0">      <tbody>      <tr>        <td style="width: 705px; height: 100%;"> <span>$$.Report_Admin_CH 您好,</span><br /> <br /> <span>问题已经解决了，请审阅详细信息，谢谢！</span><br /> <br /><br />         <!-- <span><i><b>提交人信息</b></i></span><br />                  <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">                      <tbody>                          <tr>                              <td style="width: 120px;"><span><b>姓名</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_Name</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>GID</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_GID</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>邮件</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_Email</span></td>                          </tr>                          <tr>                              <td style="width: 120px;"><span><b>职称</b></span></td>                              <td style="border-collapse: collapse; text-align: left;"><span>$$.Applicant_JobTitle</span></td>                          </tr>                      </tbody>                  </table>            <br />  --> <span><i><b>报表信息</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="width: 120px;"><span><b>报表名称</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.Report_Name</span></td>           </tr>           <tr>            <td style="width: 120px;"><span><b>报表所有者</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.ReportOwner_Name_CH</span></td>           </tr>           <tr>            <td style="width: 120px;"><span><b>权限所有者</b></span></td>            <td style="border-collapse: collapse; text-align: left;"><span>$$.Report_AccessOwner</span></td>           </tr>          </tbody>         </table> <br /> <span><i><b>报表问题</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.AccessReason</span></td>           </tr>          </tbody>         </table>         <br /> <span><i><b>错误原因</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.ErrorReason</span></td>           </tr>          </tbody>         </table>      <br /> <span><i><b>解决方案</b></i></span><br />         <table style="border: 1px solid #BECDD7; width: 515px; table-layout: fixed; word-break: break-all;" cellspacing="0" cellpadding="4">          <tbody>           <tr>            <td style="border-collapse: collapse; text-align: left;"><span>$$.ErrorSolution</span></td>           </tr>          </tbody>         </table>      </td>       </tr>      </tbody>    </table>     <br />    <br />    <br />    <br />   </body>  </html>')


update [t_ReportIssue] set CreateUserName=u.User_Name_EN from v_User u join [t_ReportIssue] t on  u.User_GID=t.CreateUser
update [t_ReportIssue] set AdminOwner=r.r_Admin from t_Report r join [t_ReportIssue] t on r.r_ID=t.r_Id
update [t_ReportIssue] set reporttitle=r.r_Name from t_Report r join [t_ReportIssue] t on r.r_ID=t.r_Id
update [t_ReportIssue] set adminownerName=u.User_Name_EN from v_User u join [t_ReportIssue] t on  u.User_GID=t.AdminOwner